<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hy.dao.HousesDao">
    <sql id="BASE_TABLE">
    housecd.houses
  </sql>
    <sql id="BASE_COLUMN">
    housesId, housesName, housesSpclty, houseState, pictureX, pictureS,
    pictureJ, mating, houseTypeId, areaZ, areaJ, areaS, developers,
    housesAddrss, period, areaId, buildType, greenRate, companyW, openHouse,
    deadLine, avgPrice, investor, plotRatio, familyNum, carportNum, fitment,
    location, recommend, crtTime, updateTime
  </sql>
    <sql id="HOUSES_SPCLTY_TABLE">
        houses_spclty
    </sql>
    <sql id="HOUSES_SPCLTY_COLUMN">
        housesSpcltyId, housesSpclty, crtTime, updateTime
    </sql>
    <sql id="HOUSE_TYPE_COLUMN">
        houseTypeId, housesId, houseTypeName, houseTypeSpci, houseTypePic, houseFTTB, houseTypeNum, houseSize, houseAvmPrice, houseTolPrice, houseType, crtTime, updateTime
    </sql>

    <insert id="insert" parameterType="com.hy.model.HousesDomain">
        INSERT INTO
        <include refid="BASE_TABLE"/>
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="housesId != null">
                housesId,
            </if>
            <if test="housesName != null">
                housesName,
            </if>

            crtTime, updateTime
        </trim>
        <trim prefix="VALUES(" suffix=")" suffixOverrides=",">
            <if test="housesId != null">
                #{housesId, jdbcType=VARCHAR},
            </if>
            <if test="housesName != null">
                #{housesName, jdbcType=VARCHAR},
            </if>

            CURRENT_TIMESTAMP,CURRENT_TIMESTAMP
        </trim>
    </insert>
    <insert id="insertHouseSpcl" parameterType="com.hy.model.HousesSpcltyDomain">
        INSERT INTO houses_spclty
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="lableId != null">
                lableId,
            </if>
            <if test="lableContext != null">
                lableContext,
            </if>
            crtTime, updateTime
        </trim>
        <trim prefix="VALUES(" suffix=")" suffixOverrides=",">
            <if test="lableId != null">
                #{lableId, jdbcType=VARCHAR},
            </if>
            <if test="lableContext != null">
                #{lableContext, jdbcType=VARCHAR},
            </if>
            CURRENT_TIMESTAMP,CURRENT_TIMESTAMP
        </trim>
    </insert>
    <insert id="insertHousePic" parameterType="com.hy.model.HousesPictureDomain">
        INSERT INTO houses_picture
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="lableId != null">
                lableId,
            </if>
            <if test="lableContext != null">
                lableContext,
            </if>

            crtTime, updateTime
        </trim>
        <trim prefix="VALUES(" suffix=")" suffixOverrides=",">
            <if test="lableId != null">
                #{lableId, jdbcType=VARCHAR},
            </if>
            <if test="lableContext != null">
                #{lableContext, jdbcType=VARCHAR},
            </if>

            CURRENT_TIMESTAMP,CURRENT_TIMESTAMP
        </trim>
    </insert>
    <insert id="insertHouseMat" parameterType="com.hy.model.HousesFacilitiesDomain">
        INSERT INTO houses_facilities
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="lableId != null">
                lableId,
            </if>
            <if test="lableContext != null">
                lableContext,
            </if>

            crtTime, updateTime
        </trim>
        <trim prefix="VALUES(" suffix=")" suffixOverrides=",">
            <if test="lableId != null">
                #{lableId, jdbcType=VARCHAR},
            </if>
            <if test="lableContext != null">
                #{lableContext, jdbcType=VARCHAR},
            </if>

            CURRENT_TIMESTAMP,CURRENT_TIMESTAMP
        </trim>
    </insert>
    <insert id="insertHouseType" parameterType="com.hy.model.HouseTypeDomain">
        INSERT INTO house_type
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="lableId != null">
                lableId,
            </if>
            <if test="lableContext != null">
                lableContext,
            </if>

            crtTime, updateTime
        </trim>
        <trim prefix="VALUES(" suffix=")" suffixOverrides=",">
            <if test="lableId != null">
                #{lableId, jdbcType=VARCHAR},
            </if>
            <if test="lableContext != null">
                #{lableContext, jdbcType=VARCHAR},
            </if>

            CURRENT_TIMESTAMP,CURRENT_TIMESTAMP
        </trim>
    </insert>

    <select id="selectHouses" parameterType="com.hy.model.HousesDomain" resultType="com.hy.model.HousesDomain">
        SELECT
        <include refid="BASE_COLUMN"/>
        FROM
        <include refid="BASE_TABLE"/>
        WHERE 1=1
        <if test="housesId != null">
            AND housesId = #{housesId, jdbcType=VARCHAR}
        </if>
        <if test="userId != null">
            AND userId = #{userId, jdbcType=VARCHAR}
        </if>
        ORDER BY updateTime DESC
    </select>
    <select id="queryAll" parameterType="com.hy.model.HousesDomain" resultType="com.hy.model.HousesDomain">
        SELECT
        <include refid="BASE_COLUMN"/>
        FROM
        <include refid="BASE_TABLE"/>
        WHERE 1=1

        <if test="housesName != null">
            and housesName = #{housesName, jdbcType=VARCHAR}
        </if>
        <if test="housesAddrss != null">
            and housesAddrss = #{housesAddrss, jdbcType=VARCHAR}
        </if>
        <if test="location != null">
            and location = #{location, jdbcType=VARCHAR}
        </if>
        <if test="areaId != null">
            or areaId = #{areaId, jdbcType=VARCHAR}
        </if>
        <if test="avgPrice != null">
            or ( avgPrice &gt;= #{avgPrice, jdbcType=VARCHAR}
        </if>
        <if test="avgPrice != null">
            and avgPrice &lt;= #{maxPrice, jdbcType=VARCHAR})
        </if>
        <if test="housesType != null">
            and housesId in (SELECT housesId from housecd.house_type
            where houseTypeName like concat('%',#{maxPrice, jdbcType=VARCHAR},'%') )
        </if>
        <if test="fitment != null">
            and fitment = #{fitment, jdbcType=VARCHAR})
        </if>
        <if test="areaJ != null">
            and areaJ = #{areaJ, jdbcType=VARCHAR})
        </if>
        <if test="crtTime != null">
            and crtTime = #{crtTime, jdbcType=VARCHAR})
        </if>
        <if test="houseState != null">
            and houseState = #{houseState, jdbcType=VARCHAR})
        </if>
        <if test="housesSpclty != null">
            and housesSpclty in (SELECT lableId from housecd.houses_spclty
            where lableContext like concat('%',#{housesSpclty, jdbcType=VARCHAR},'%') )
        </if>
        ORDER BY
        <if test="bigTOSmall != null">
            avgPrice,
        </if>
        <if test="smallTOBig != null">
            avgPrice ASC,
        </if>
        updateTime DESC
    </select>
    <select id="queryHouseId" parameterType="com.hy.model.HousesDomain" resultType="String">
        SELECT
        housesId
        FROM
        <include refid="BASE_TABLE"/>
        WHERE 1=1
        <if test="housesName != null">
            AND housesName = #{housesId, jdbcType=VARCHAR}
        </if>
        <if test="developers != null">
            AND developers = #{userId, jdbcType=VARCHAR}
        </if>
    </select>
    <select id="querySpc" parameterType="String" resultType="com.hy.model.HousesSpcltyDomain">
        SELECT
        *
        FROM
        houses_spclty
        WHERE 1=1
        <if test="spc != null">
            AND lableId = #{spc, jdbcType=VARCHAR}
        </if>
    </select>
    <select id="queryPic" parameterType="String" resultType="com.hy.model.HousesPictureDomain">
        SELECT
        *
        FROM
        houses_picture
        WHERE 1=1
        <if test="pic != null">
            AND lableId = #{pic, jdbcType=VARCHAR}
        </if>
    </select>
    <select id="queryMat" parameterType="String" resultType="com.hy.model.HousesFacilitiesDomain">
        SELECT
        *
        FROM
        houses_facilities
        WHERE 1=1
        <if test="mat != null">
            AND lableId = #{pic, jdbcType=VARCHAR}
        </if>
    </select>
    <select id="queryType" parameterType="com.hy.model.HouseTypeDomain" resultType="com.hy.model.HouseTypeDomain">
        SELECT
        <include refid="HOUSE_TYPE_COLUMN"/>
        FROM
        house_type
        WHERE 1=1
        <if test="houseTypeId != null">
            AND houseTypeId = #{houseTypeId}
        </if>
    </select>
    <select id="querySpclty" resultType="com.hy.model.HousesSpcltyDomain">
        select
        DISTINCT housesSpclty
        from housecd.houses_spclty
    </select>
</mapper>